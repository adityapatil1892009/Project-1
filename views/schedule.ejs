<!DOCTYPE html>
<html lang="en">
<%- include('partials/head') %>
<body>
    <%- include('partials/header') %>
    <%- include('partials/navbar') %>

    <main class="container" style="padding: 30px 20px; max-width: 1400px; margin: 0 auto;">
        <div style="margin-bottom: 25px;">
            <h1 style="color: #2c3e50; margin: 0 0 5px 0; font-size: 22px; font-weight: 600;">Water Supply Schedules</h1>
            <p style="color: #7f8c8d; font-size: 13px; margin: 0;">View water supply timings for different areas of Pune</p>
        </div>
        
        <div style="margin-bottom: 25px;">
            <input type="text" id="searchInput" placeholder="Search by area or zone..." style="width: 100%; padding: 10px 15px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; font-family: inherit;">
        </div>

        <div class="schedule-container" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
            <% 
            const cityOrder = ["Shivajinagar", "Kothrud", "Hadapsar", "Viman Nagar", "Deccan", "Aundh", "Baner", "Kondhwa", "Wakad", "Pimpri", "Chinchwad", "Hinjewadi", "Karve Nagar", "Warje", "Sinhagad Road"];
            %>
            <% if (schedule) { %>
                <% cityOrder.forEach(area => {
                    if (schedule[area]) {
                        const details = schedule[area];
                        const status = details.status || 'Active';
                        const timing = details.timing || '';
                        const duration = details.duration || '';
                        const zone = details.zone || '';
                        let statusColor = '#27ae60';
                        let statusBg = '#d5f4e6';
                        if (status === 'Interrupted') {
                            statusColor = '#e74c3c';
                            statusBg = '#fadbd8';
                        } else if (status === 'Scheduled') {
                            statusColor = '#3498db';
                            statusBg = '#d6eaf8';
                        }
                %>
                    <div style="background: white; border-radius: 4px; padding: 14px; border: 1px solid #ecf0f1; border-left: 3px solid #3498db;">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px;">
                            <div>
                                <h3 style="color: #2c3e50; margin: 0 0 2px 0; font-size: 14px; font-weight: 600;"><%= area %></h3>
                                <p style="color: #95a5a6; margin: 0; font-size: 11px;"><%= zone %></p>
                            </div>
                            <span style="background-color: <%= statusBg %>; color: <%= statusColor %>; padding: 2px 7px; border-radius: 2px; font-size: 9px; font-weight: 600; white-space: nowrap;">
                                <%= status %>
                            </span>
                        </div>
                        
                        <div style="display: flex; align-items: flex-start; margin-bottom: 8px; padding-bottom: 8px; border-bottom: 1px solid #ecf0f1;">
                            <span style="color: #3498db; margin-right: 8px; font-size: 13px; min-width: 14px;">‚è∞</span>
                            <div style="flex: 1;">
                                <p style="margin: 0; font-size: 10px; color: #95a5a6; font-weight: 500;">Timing</p>
                                <p style="margin: 0; font-size: 12px; font-weight: 600; color: #2c3e50;"><%= timing %></p>
                            </div>
                        </div>
                        
                        <div style="display: flex; align-items: flex-start;">
                            <span style="color: #3498db; margin-right: 8px; font-size: 13px; min-width: 14px;">üìã</span>
                            <div style="flex: 1;">
                                <p style="margin: 0; font-size: 10px; color: #95a5a6; font-weight: 500;">Duration</p>
                                <p style="margin: 0; font-size: 12px; font-weight: 600; color: #2c3e50;"><%= duration %></p>
                            </div>
                        </div>
                        
                        <% if (details.message) { %>
                            <div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid #ecf0f1;">
                                <p style="margin: 0; font-size: 10px; color: #e74c3c; display: flex; align-items: center;">
                                    <span style="margin-right: 4px;">‚ö†</span>
                                    <%= details.message %>
                                </p>
                            </div>
                        <% } %>
                    </div>
                <% }
                }); %>
            <% } else { %>
                <div style="grid-column: 1 / -1; padding: 40px; text-align: center; color: #999;">
                    <p>No schedule information available.</p>
                </div>
            <% } %>
        </div>
    </main>

    <%- include('partials/footer') %>
    
    <script>
        document.getElementById('searchInput').addEventListener('keyup', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const cards = document.querySelectorAll('.schedule-container > div');
            cards.forEach(card => {
                const text = card.textContent.toLowerCase();
                card.style.display = text.includes(searchTerm) ? 'block' : 'none';
            });
        });
    </script>
</body>
</html>